USE bdg3;

CREATE TABLE editoriales (
    id_editorial INT PRIMARY KEY IDENTITY(1,1),
    nombre VARCHAR(100) NOT NULL,
    razon_social VARCHAR(100), 
    cuit VARCHAR(30), 
    direccion VARCHAR(255),
    telefono VARCHAR(20),   
    mail VARCHAR(50), 
);

CREATE TABLE clientes (
    id_cliente INT PRIMARY KEY IDENTITY(1,1),
    nombre VARCHAR(100),
    email VARCHAR(100),
    telefono VARCHAR(20),
    direccion VARCHAR(255)
);


CREATE TABLE generos (
    id_genero INT PRIMARY KEY IDENTITY(1,1),
    nombre VARCHAR(100)
);


CREATE TABLE libros (
    id_libro INT PRIMARY KEY IDENTITY(1,1),
    titulo VARCHAR(255),
    autor VARCHAR(100),
    isbn VARCHAR(20),
    precio FLOAT,
    stock INT,
    id_genero INT,
    FOREIGN KEY (id_genero) REFERENCES generos(id_genero)
);

CREATE TABLE compra_editorial (
    id_compra_editorial INT PRIMARY KEY IDENTITY(1,1),
    id_editorial INT,
    fecha DATE,
    FOREIGN KEY (id_editorial) REFERENCES editoriales(id_editorial)
);


CREATE TABLE detalle_compra_editorial (
    id_detalle INT PRIMARY KEY IDENTITY(1,1),
    id_compra_editorial INT,
    id_libro INT,
    cantidad INT,
    FOREIGN KEY (id_compra_editorial) REFERENCES compra_editorial(id_compra_editorial),
    FOREIGN KEY (id_libro) REFERENCES libros(id_libro)
);

CREATE TABLE listas_de_precios (
    id_lista_precio INT PRIMARY KEY IDENTITY(1,1),
    id_editorial INT,
    nombre_editorial VARCHAR(255),
    id_libro INT,
    nombre_libro VARCHAR(255),
    precio FLOAT,
    FOREIGN KEY (id_editorial) REFERENCES editoriales(id_editorial),
    FOREIGN KEY (id_libro) REFERENCES libros(id_libro)
);


CREATE TABLE venta_cliente (
    id_venta_cliente INT PRIMARY KEY IDENTITY(1,1),
    id_cliente INT,
    fecha DATE,
    total FLOAT,
    FOREIGN KEY (id_cliente) REFERENCES clientes(id_cliente)
);

CREATE TABLE detalle_venta_cliente (
    id_detalle INT PRIMARY KEY IDENTITY(1,1),
    id_venta_cliente INT,
    id_libro INT,
    cantidad INT,
    FOREIGN KEY (id_venta_cliente) REFERENCES venta_cliente(id_venta_cliente),
    FOREIGN KEY (id_libro) REFERENCES libros(id_libro)
);

CREATE TABLE carrito (
    id_carrito INT PRIMARY KEY IDENTITY(1,1),
    id_cliente INT,
    fecha DATE,
    FOREIGN KEY (id_cliente) REFERENCES clientes(id_cliente)
);


CREATE TABLE detalle_carrito (
    id_detalle INT PRIMARY KEY IDENTITY(1,1),
    id_carrito INT,
    id_libro INT,
    cantidad INT,
    FOREIGN KEY (id_carrito) REFERENCES carrito(id_carrito),
    FOREIGN KEY (id_libro) REFERENCES libros(id_libro)
);